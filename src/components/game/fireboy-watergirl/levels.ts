import type { LevelData } from "./types"

// Tile legend:
// 0 = empty, 1 = wall, 2 = lava, 3 = water, 4 = goo, 5 = mechanism
//
// Physics: jump height ~4.6 tiles, horizontal ~5 tiles per jump
// Design rule: max 2-row vertical gaps between platforms, max 4-col horizontal gaps

export const levels: LevelData[] = [
  // Level 1: The Temple Entrance (tutorial - no mechanisms)
  {
    name: "The Temple Entrance",
    tiles: [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,1,1,2,2,2,1,1,1,3,3,3,1,1,1,1,1,1,1,1,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ],
    fireSpawn: { x: 3, y: 16 },
    waterSpawn: { x: 21, y: 16 },
    fireDoor: { x: 2, y: 2, type: "fire" },
    waterDoor: { x: 22, y: 2, type: "water" },
    gems: [
      { x: 4, y: 14, type: "fire", collected: false },
      { x: 8, y: 10, type: "fire", collected: false },
      { x: 4, y: 6, type: "fire", collected: false },
      { x: 20, y: 14, type: "water", collected: false },
      { x: 16, y: 10, type: "water", collected: false },
      { x: 20, y: 6, type: "water", collected: false },
    ],
    buttons: [],
    levers: [],
    mechanisms: [],
    movingPlatforms: [],
  },

  // Level 2: Switching Paths (introduces buttons)
  {
    name: "Switching Paths",
    tiles: [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,1,1,0,0,0,0,5,0,0,0,0,1,1,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,3,3,1,1,1,1,1,1,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ],
    fireSpawn: { x: 3, y: 16 },
    waterSpawn: { x: 21, y: 16 },
    fireDoor: { x: 2, y: 2, type: "fire" },
    waterDoor: { x: 22, y: 2, type: "water" },
    gems: [
      { x: 4, y: 12, type: "fire", collected: false },
      { x: 10, y: 10, type: "fire", collected: false },
      { x: 7, y: 4, type: "fire", collected: false },
      { x: 20, y: 12, type: "water", collected: false },
      { x: 14, y: 10, type: "water", collected: false },
      { x: 17, y: 4, type: "water", collected: false },
    ],
    buttons: [
      { x: 10, y: 7, width: 2, triggerId: "gate1", pressed: false },
      { x: 13, y: 11, width: 2, triggerId: "gate1", pressed: false },
    ],
    levers: [],
    mechanisms: [
      { id: "gate1", tiles: [{ x: 12, y: 5 }, { x: 12, y: 6 }], type: "door", open: false },
    ],
    movingPlatforms: [],
  },

  // Level 3: The Elevator (introduces moving platforms and levers)
  {
    name: "The Elevator",
    tiles: [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,3,3,1,1,1,1,1,1,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ],
    fireSpawn: { x: 3, y: 16 },
    waterSpawn: { x: 21, y: 16 },
    fireDoor: { x: 2, y: 2, type: "fire" },
    waterDoor: { x: 22, y: 2, type: "water" },
    gems: [
      { x: 7, y: 4, type: "fire", collected: false },
      { x: 2, y: 9, type: "fire", collected: false },
      { x: 12, y: 11, type: "fire", collected: false },
      { x: 17, y: 4, type: "water", collected: false },
      { x: 22, y: 9, type: "water", collected: false },
      { x: 12, y: 13, type: "water", collected: false },
    ],
    buttons: [],
    levers: [
      { x: 12, y: 12, triggerId: "gate2", activated: false },
    ],
    mechanisms: [
      { id: "gate2", tiles: [{ x: 12, y: 4 }], type: "door", open: false },
    ],
    movingPlatforms: [
      {
        x: 5 * 32, y: 15 * 32, width: 3,
        pathStart: { x: 5 * 32, y: 15 * 32 },
        pathEnd: { x: 5 * 32, y: 10 * 32 },
        speed: 0.008, progress: 0, direction: 1,
      },
      {
        x: 17 * 32, y: 10 * 32, width: 3,
        pathStart: { x: 17 * 32, y: 15 * 32 },
        pathEnd: { x: 17 * 32, y: 10 * 32 },
        speed: 0.008, progress: 1, direction: -1,
      },
    ],
  },

  // Level 4: The Crossroads (buttons, green goo, horizontal moving platforms)
  {
    name: "The Crossroads",
    tiles: [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,1,5,5,0,0,0,0,0,0,0,5,5,1,0,0,0,0,0,1],
      [1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1],
      [1,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,0,2,2,4,4,4,1,1,1,4,4,4,3,3,0,1,1,1,1,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ],
    fireSpawn: { x: 2, y: 16 },
    waterSpawn: { x: 22, y: 16 },
    fireDoor: { x: 2, y: 2, type: "fire" },
    waterDoor: { x: 22, y: 2, type: "water" },
    gems: [
      { x: 3, y: 8, type: "fire", collected: false },
      { x: 10, y: 2, type: "fire", collected: false },
      { x: 7, y: 12, type: "fire", collected: false },
      { x: 12, y: 6, type: "fire", collected: false },
      { x: 21, y: 8, type: "water", collected: false },
      { x: 14, y: 2, type: "water", collected: false },
      { x: 17, y: 12, type: "water", collected: false },
      { x: 12, y: 10, type: "water", collected: false },
    ],
    buttons: [
      { x: 11, y: 7, width: 2, triggerId: "left-gate", pressed: false },
      { x: 12, y: 11, width: 2, triggerId: "right-gate", pressed: false },
    ],
    levers: [],
    mechanisms: [
      { id: "left-gate", tiles: [{ x: 7, y: 5 }, { x: 8, y: 5 }], type: "door", open: false },
      { id: "right-gate", tiles: [{ x: 16, y: 5 }, { x: 17, y: 5 }], type: "door", open: false },
    ],
    movingPlatforms: [
      {
        x: 1 * 32, y: 13 * 32, width: 3,
        pathStart: { x: 1 * 32, y: 13 * 32 },
        pathEnd: { x: 4 * 32, y: 13 * 32 },
        speed: 0.006, progress: 0, direction: 1,
      },
      {
        x: 20 * 32, y: 13 * 32, width: 3,
        pathStart: { x: 18 * 32, y: 13 * 32 },
        pathEnd: { x: 21 * 32, y: 13 * 32 },
        speed: 0.006, progress: 1, direction: -1,
      },
    ],
  },

  // Level 5: The Final Chamber (combines everything)
  {
    name: "The Final Chamber",
    tiles: [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,1,1,0,0,0,0,5,0,0,0,0,1,1,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,1,5,1,0,0,0,0,0,0,0,1,5,1,0,0,0,0,0,1],
      [1,0,0,0,0,0,1,0,1,0,0,1,1,1,0,0,1,0,1,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,0,2,2,4,4,1,1,1,1,1,1,1,4,4,3,3,0,1,1,1,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ],
    fireSpawn: { x: 1, y: 16 },
    waterSpawn: { x: 23, y: 16 },
    fireDoor: { x: 2, y: 2, type: "fire" },
    waterDoor: { x: 22, y: 2, type: "water" },
    gems: [
      { x: 9, y: 2, type: "fire", collected: false },
      { x: 4, y: 7, type: "fire", collected: false },
      { x: 7, y: 12, type: "fire", collected: false },
      { x: 12, y: 9, type: "fire", collected: false },
      { x: 2, y: 13, type: "fire", collected: false },
      { x: 15, y: 2, type: "water", collected: false },
      { x: 20, y: 7, type: "water", collected: false },
      { x: 17, y: 12, type: "water", collected: false },
      { x: 12, y: 7, type: "water", collected: false },
      { x: 22, y: 13, type: "water", collected: false },
    ],
    buttons: [
      { x: 11, y: 8, width: 2, triggerId: "center-gate", pressed: false },
    ],
    levers: [
      { x: 4, y: 8, triggerId: "left-cage", activated: false },
      { x: 20, y: 8, triggerId: "right-cage", activated: false },
    ],
    mechanisms: [
      { id: "center-gate", tiles: [{ x: 12, y: 4 }, { x: 12, y: 5 }], type: "door", open: false },
      { id: "left-cage", tiles: [{ x: 7, y: 11 }], type: "door", open: false },
      { id: "right-cage", tiles: [{ x: 17, y: 11 }], type: "door", open: false },
    ],
    movingPlatforms: [
      {
        x: 4 * 32, y: 15 * 32, width: 2,
        pathStart: { x: 4 * 32, y: 15 * 32 },
        pathEnd: { x: 4 * 32, y: 10 * 32 },
        speed: 0.007, progress: 0, direction: 1,
      },
      {
        x: 19 * 32, y: 10 * 32, width: 2,
        pathStart: { x: 19 * 32, y: 15 * 32 },
        pathEnd: { x: 19 * 32, y: 10 * 32 },
        speed: 0.007, progress: 1, direction: -1,
      },
      {
        x: 9 * 32, y: 7 * 32, width: 3,
        pathStart: { x: 6 * 32, y: 7 * 32 },
        pathEnd: { x: 14 * 32, y: 7 * 32 },
        speed: 0.005, progress: 0.3, direction: 1,
      },
    ],
  },
]

export function cloneLevel(index: number): LevelData {
  const src = levels[index]
  return {
    ...src,
    tiles: src.tiles.map(row => [...row]),
    fireSpawn: { ...src.fireSpawn },
    waterSpawn: { ...src.waterSpawn },
    fireDoor: { ...src.fireDoor },
    waterDoor: { ...src.waterDoor },
    gems: src.gems.map(g => ({ ...g, collected: false })),
    buttons: src.buttons.map(b => ({ ...b, pressed: false })),
    levers: src.levers.map(l => ({ ...l, activated: false })),
    mechanisms: src.mechanisms.map(m => ({ ...m, tiles: m.tiles.map(t => ({ ...t })), open: false })),
    movingPlatforms: src.movingPlatforms.map(p => ({
      ...p,
      x: p.pathStart.x + (p.pathEnd.x - p.pathStart.x) * p.progress,
      y: p.pathStart.y + (p.pathEnd.y - p.pathStart.y) * p.progress,
      pathStart: { ...p.pathStart },
      pathEnd: { ...p.pathEnd },
    })),
  }
}
